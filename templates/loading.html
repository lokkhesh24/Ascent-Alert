<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading - Ascent Alert</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body class="loading-body">
    <div class="loading-container">
        <div class="speedometer-wrapper">
            <div class="speedometer">
                <canvas id="speedometerCanvas" width="200" height="200"></canvas>
            </div>
        </div>
        <div class="driving-tips">
            <p id="tip-text"><i class="fas fa-lightbulb"></i> <span class="tip-content">Safety Tip: Always maintain a safe speed on ghat roads, especially during sharp turns.</span></p>
        </div>
    </div>

    <script>
        // Driving tips carousel
        const tips = [
            "Safety Tip: Always maintain a safe speed on ghat roads, especially during sharp turns.",
            "Safety Tip: Use low gears when descending steep slopes to maintain control.",
            "Safety Tip: Keep a safe distance from other vehicles on narrow ghat roads.",
            "Safety Tip: Check your brakes before starting a journey on mountainous terrain.",
            "Safety Tip: Avoid overtaking on blind curves; wait for a clear view ahead.",
            "Safety Tip: Use fog lights and reduce speed in low-visibility conditions like fog or heavy rain.",
            "Safety Tip: Watch for loose gravel or rocks on the road, which can cause skidding."
        ];

        let currentTipIndex = 0;
        const tipElement = document.querySelector('.tip-content');

        function showNextTip() {
            currentTipIndex = (currentTipIndex + 1) % tips.length;
            tipElement.textContent = tips[currentTipIndex];
        }

        // Change tip every 3 seconds
        setInterval(showNextTip, 1000);

        // Speedometer animation
        const canvas = document.getElementById('speedometerCanvas');
        const ctx = canvas.getContext('2d');
        let speed = 0;
        const maxSpeed = 120;
        const radius = 80;
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        function drawSpeedometer() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw outer arc
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, Math.PI, 2 * Math.PI);
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 10;
            ctx.stroke();

            // Draw speed arc
            const speedAngle = (speed / maxSpeed) * Math.PI + Math.PI;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, Math.PI, speedAngle);
            ctx.strokeStyle = '#E10600';
            ctx.lineWidth = 10;
            ctx.stroke();

            // Draw needle
            const needleAngle = (speed / maxSpeed) * Math.PI + Math.PI;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            ctx.lineTo(centerX + radius * Math.cos(needleAngle), centerY + radius * Math.sin(needleAngle));
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 3;
            ctx.stroke();

            // Draw center circle
            ctx.beginPath();
            ctx.arc(centerX, centerY, 10, 0, 2 * Math.PI);
            ctx.fillStyle = '#E10600';
            ctx.fill();

            // Animate speed
            speed = (speed + 1) % maxSpeed;
            requestAnimationFrame(drawSpeedometer);
        }

        drawSpeedometer();

        // Redirect after 3 seconds
        setTimeout(() => {
            window.location.href = "{{ url_for('login') }}";
        }, 5000);
    </script>
</body>
</html>